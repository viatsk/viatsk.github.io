
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <title> Stacy's Garden </title>
  <!-- Link to external CSS --!>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.0/highlight.min.js"> </script>
  <link href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:wght@300&display=swap" rel="stylesheet"> 
  <style type="text/css">
  body {
    font-family: 'Alegreya Sans', sans-serif;
    padding: 35px 0px;
    background-color: #fdfdfe;
    max-width: 800px;
    margin: 0 auto;
  }

  ul {
    list-style-type: none;
    padding: 0;
    margin: 30px 0px;
  }

  li {
    margin: 0px 5px;
  }

  h3 {
    padding: 0px 0px;
    margin: 5px 0px;
  }
  </style>
  <script src="papaparse.min.js"></script>
  <script src="markdown-it.min.js"></script>

</head>

<body>
  <header>
    <h1>
        üçÉüåøüå± Stacy's Idea Garden üå±üåøüçÉ
    </h1>
    <nav>
        <a href="books.html">Books</a>  |  <a href="Resume.pdf">Resume</a>
    </nav>
   <br>
  </header>


  <main>
    <ul id="ThoughtFeed">
        <li>
        <h3> Garden!! </h3>
        <div><p> This is text! </p> </div>
        </li>
    </ul>
  </main>

  <script>
    function main() {
        const url = "/test.csv";
        var   container = document.getElementById('ThoughtFeed');
//        var   csvText   = readTextFile(filename); 
//        var   csvText = 'TS,body\n6/11/2020 22:29:14,"This is some text blah blah blah  \n **bold**\n```python\n # a python comment \n def main():\n\treturn\n```"\n6/12/2020 22:15:09,"This is a second sample"';

        const contents = Papa.parse(url, {
            delimiter: ",",
            newline: "\n",
            download: true,
            worker: true,
            header: true,
            step : parse_row(container),
            complete: function(results) {
                console.log("DONE", results);
            },
            error : function (error) {
                console.log(error);
            },
        });
    }

    function parse_row(container) {
        return function (row) {
            var md = window.markdownit({
                breaks:true, // TODO: What happens without this? 
                typographer:true,
                highlight: function (str, lang) {
                    if (lang && hljs.getLanguage(lang)) {
                        try {
                            return hljs.highlight(lang, str).value;
                        } catch (___) {}
                    }
                    return '';

                },
            });
            const TS = row.data["TS"];

            const body = row.data["body"];
            const thought_html = `<li>
            <h3>${md.render(TS)} </h3>
            <div><p>${md.render(body)} </p></div>
            </li>`;
            container.insertAdjacentHTML('afterBegin', thought_html);
        }
    }

    main();

  </script>


</body>
</html>
